<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø§Ù„Ù…Ø³Ù„Ù… Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±ÙŠ</title>

<!-- Telegram Web App -->
<script src="https://telegram.org/js/telegram-web-app.js"></script>

<style>
body {
  margin: 0;
  font-family: "Amiri", serif;
  background: #f5f5f5;
  text-align: center;
}
#splash {
  position: fixed;
  inset: 0;
  background: #000;
  color: #fff;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
}
#splash img {
  width: 180px;
}
header {
  background: url("images/mosque.jpg") center/cover;
  color: white;
  padding: 30px 10px;
  font-size: 24px;
}
.grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 15px;
  padding: 20px;
}
.grid div {
  background: white;
  padding: 20px;
  border-radius: 15px;
  font-size: 18px;
  cursor: pointer;
  box-shadow: 0 4px 6px rgba(0,0,0,.1);
}
section {
  display: none;
  padding: 20px;
}
button {
  padding: 10px 15px;
  margin: 5px;
  border: none;
  border-radius: 8px;
  background: #1e6f5c;
  color: white;
  font-size: 16px;
}
.card {
  background: white;
  padding: 15px;
  margin: 10px auto;
  border-radius: 10px;
  max-width: 600px;
}
#mushaf img {
  width: 95%;
  max-width: 600px;
  margin: 10px auto;
}
#arrow {
  font-size: 80px;
  transition: transform 0.3s linear;
}
</style>
</head>

<body>

<!-- Splash -->
<div id="splash">
  <img src="images/splash-quran.jpg">
  <h2>Ù…Ø±Ø­Ø¨Ù‹Ø§ Ø¨Ùƒ ÙÙŠ Ø§Ù„Ù…Ø³Ù„Ù… Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±ÙŠ</h2>
</div>

<!-- Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
<div id="main" style="display:none">
<header>Ø§Ù„Ù…Ø³Ù„Ù… Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±ÙŠ</header>

<div class="grid">
  <div onclick="openSection('quran')">ğŸ“– Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ…</div>
  <div onclick="openSection('adkar')">ğŸŒ… Ø§Ù„Ø£Ø°ÙƒØ§Ø±</div>
  <div onclick="openSection('prayer')">ğŸ•‹ Ø§Ù„ØªÙˆÙ‚ÙŠØª ÙˆØ§Ù„Ø£Ø°Ø§Ù†</div>
  <div onclick="openSection('duas')">ğŸ¤² Ø§Ù„Ø£Ø¯Ø¹ÙŠØ©</div>
  <div onclick="openSection('qibla')">ğŸ§­ Ø§Ù„Ù‚Ø¨Ù„Ø©</div>
</div>
</div>

<!-- Ø§Ù„Ù‚Ø±Ø¢Ù† -->
<section id="quran">
<h2>Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ…</h2>
<button onclick="loadMushaf('hafs')">Ù…ØµØ­Ù Ø­ÙØµ</button>
<button onclick="loadMushaf('warsh')">Ù…ØµØ­Ù ÙˆØ±Ø´</button>
<button onclick="openSection('khatma')">Ø§Ù„Ø®ØªÙ…Ø© Ø§Ù„Ø°ÙƒÙŠØ©</button>
<div id="mushaf"></div>
</section>

<!-- Ø§Ù„Ø®ØªÙ…Ø© -->
<section id="khatma">
<h2>Ø§Ù„Ø®ØªÙ…Ø© Ø§Ù„Ø°ÙƒÙŠØ©</h2>
<div class="card">
ğŸ“Œ ÙŠØªÙ… Ø­ÙØ¸ Ø¢Ø®Ø± ØµÙØ­Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§<br>
Ø¬Ø²Ø¡ ÙŠÙˆÙ…ÙŠÙ‹Ø§ â€“ 20 ØµÙØ­Ø©
</div>
<button onclick="resumeReading()">Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©</button>
</section>

<!-- Ø§Ù„Ø£Ø°ÙƒØ§Ø± -->
<section id="adkar">
<h2>Ø§Ù„Ø£Ø°ÙƒØ§Ø±</h2>
<div class="card">
<b>Ø£Ø°ÙƒØ§Ø± Ø§Ù„ØµØ¨Ø§Ø­</b><br>
Ø£ØµØ¨Ø­Ù†Ø§ ÙˆØ£ØµØ¨Ø­ Ø§Ù„Ù…Ù„Ùƒ Ù„Ù„Ù‡...<br><br>
<b>Ø£Ø°ÙƒØ§Ø± Ø§Ù„Ù…Ø³Ø§Ø¡</b><br>
Ø£Ù…Ø³ÙŠÙ†Ø§ ÙˆØ£Ù…Ø³Ù‰ Ø§Ù„Ù…Ù„Ùƒ Ù„Ù„Ù‡...<br><br>
<b>Ø£Ø°ÙƒØ§Ø± Ø§Ù„Ù„ÙŠÙ„</b><br>
Ø¨Ø§Ø³Ù…Ùƒ Ø§Ù„Ù„Ù‡Ù… Ø£Ù…ÙˆØª ÙˆØ£Ø­ÙŠØ§
</div>
</section>

<!-- Ø§Ù„Ø£Ø¯Ø¹ÙŠØ© -->
<section id="duas">
<h2>Ø£Ø¯Ø¹ÙŠØ© Ù…Ø£Ø«ÙˆØ±Ø©</h2>
<div class="card">
Ø§Ù„Ù„Ù‡Ù… Ø¥Ù†Ùƒ Ø¹ÙÙˆ ØªØ­Ø¨ Ø§Ù„Ø¹ÙÙˆ ÙØ§Ø¹ÙÙ Ø¹Ù†Ø§<br><br>
Ø±Ø¨Ù†Ø§ Ù„Ø§ ØªØ²Øº Ù‚Ù„ÙˆØ¨Ù†Ø§ Ø¨Ø¹Ø¯ Ø¥Ø° Ù‡Ø¯ÙŠØªÙ†Ø§<br><br>
Ø§Ù„Ù„Ù‡Ù… Ø§Ø¬Ø¹Ù„ Ø§Ù„Ù‚Ø±Ø¢Ù† Ø±Ø¨ÙŠØ¹ Ù‚Ù„ÙˆØ¨Ù†Ø§
</div>
</section>

<!-- Ù…ÙˆØ§Ù‚ÙŠØª Ø§Ù„ØµÙ„Ø§Ø© -->
<section id="prayer">
<h2>Ù…ÙˆØ§Ù‚ÙŠØª Ø§Ù„ØµÙ„Ø§Ø© â€“ Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±</h2>
<select id="wilayaSelect"></select>
<div id="prayerTimes" class="card"></div>
</section>

<!-- Ø§Ù„Ù‚Ø¨Ù„Ø© -->
<section id="qibla">
<h2>Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ù‚Ø¨Ù„Ø©</h2>
<div id="arrow">â¬†ï¸</div>
<p id="qiblaText">Ø¬Ø§Ø±ÙŠ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø§ØªØ¬Ø§Ù‡...</p>
</section>

<script>
// Telegram WebApp
if (window.Telegram) {
  Telegram.WebApp.expand();
}

// Splash
setTimeout(() => {
  splash.style.display = "none";
  main.style.display = "block";
}, 2500);

// Ø§Ù„ØªÙ†Ù‚Ù„
function openSection(id) {
  document.querySelectorAll("section").forEach(s => s.style.display="none");
  document.getElementById(id).style.display="block";
}

// Ø§Ù„Ù…ØµØ­Ù
function loadMushaf(type) {
  const m = document.getElementById("mushaf");
  m.innerHTML = "";
  for (let i = 1; i <= 604; i++) {
    const img = document.createElement("img");
    img.src = `images/${type}/${i}.jpg`;
    img.onclick = () => localStorage.setItem("lastPage", i);
    m.appendChild(img);
  }
}

// Ø§Ù„Ø®ØªÙ…Ø©
function resumeReading() {
  const page = localStorage.getItem("lastPage") || 1;
  loadMushaf("hafs");
  setTimeout(() => {
    document.querySelectorAll("#mushaf img")[page-1]?.scrollIntoView();
  }, 500);
}

// Ø§Ù„ÙˆÙ„Ø§ÙŠØ§Øª 58
const wilayas = [
"Ø£Ø¯Ø±Ø§Ø±","Ø§Ù„Ø´Ù„Ù","Ø§Ù„Ø£ØºÙˆØ§Ø·","Ø£Ù… Ø§Ù„Ø¨ÙˆØ§Ù‚ÙŠ","Ø¨Ø§ØªÙ†Ø©","Ø¨Ø¬Ø§ÙŠØ©","Ø¨Ø³ÙƒØ±Ø©","Ø¨Ø´Ø§Ø±","Ø§Ù„Ø¨Ù„ÙŠØ¯Ø©","Ø§Ù„Ø¨ÙˆÙŠØ±Ø©",
"ØªÙ…Ù†Ø±Ø§Ø³Øª","ØªØ¨Ø³Ø©","ØªÙ„Ù…Ø³Ø§Ù†","ØªÙŠØ§Ø±Øª","ØªÙŠØ²ÙŠ ÙˆØ²Ùˆ","Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±","Ø§Ù„Ø¬Ù„ÙØ©","Ø¬ÙŠØ¬Ù„","Ø³Ø·ÙŠÙ","Ø³Ø¹ÙŠØ¯Ø©",
"Ø³ÙƒÙŠÙƒØ¯Ø©","Ø³ÙŠØ¯ÙŠ Ø¨Ù„Ø¹Ø¨Ø§Ø³","Ø¹Ù†Ø§Ø¨Ø©","Ù‚Ø§Ù„Ù…Ø©","Ù‚Ø³Ù†Ø·ÙŠÙ†Ø©","Ø§Ù„Ù…Ø¯ÙŠØ©","Ù…Ø³ØªØºØ§Ù†Ù…","Ø§Ù„Ù…Ø³ÙŠÙ„Ø©","Ù…Ø¹Ø³ÙƒØ±","ÙˆØ±Ù‚Ù„Ø©",
"ÙˆÙ‡Ø±Ø§Ù†","Ø§Ù„Ø¨ÙŠØ¶","Ø¥Ù„ÙŠØ²ÙŠ","Ø¨Ø±Ø¬ Ø¨ÙˆØ¹Ø±ÙŠØ±ÙŠØ¬","Ø¨ÙˆÙ…Ø±Ø¯Ø§Ø³","Ø§Ù„Ø·Ø§Ø±Ù","ØªÙ†Ø¯ÙˆÙ","ØªÙŠØ³Ù…Ø³ÙŠÙ„Øª","Ø§Ù„ÙˆØ§Ø¯ÙŠ","Ø®Ù†Ø´Ù„Ø©",
"Ø³ÙˆÙ‚ Ø£Ù‡Ø±Ø§Ø³","ØªÙŠØ¨Ø§Ø²Ø©","Ù…ÙŠÙ„Ø©","Ø¹ÙŠÙ† Ø§Ù„Ø¯ÙÙ„Ù‰","Ø§Ù„Ù†Ø¹Ø§Ù…Ø©","Ø¹ÙŠÙ† ØªÙ…ÙˆØ´Ù†Øª","ØºØ±Ø¯Ø§ÙŠØ©","ØºÙ„ÙŠØ²Ø§Ù†",
"ØªÙŠÙ…ÙŠÙ…ÙˆÙ†","Ø¨Ø±Ø¬ Ø¨Ø§Ø¬ÙŠ Ù…Ø®ØªØ§Ø±","Ø£ÙˆÙ„Ø§Ø¯ Ø¬Ù„Ø§Ù„","Ø¨Ù†ÙŠ Ø¹Ø¨Ø§Ø³","Ø¥Ù† ØµØ§Ù„Ø­","Ø¥Ù† Ù‚Ø²Ø§Ù…","ØªÙ‚Ø±Øª","Ø¬Ø§Ù†Øª","Ø§Ù„Ù…ØºÙŠØ±","Ø§Ù„Ù…Ù†ÙŠØ¹Ø©"
];

wilayas.forEach(w => {
  wilayaSelect.innerHTML += `<option>${w}</option>`;
});

wilayaSelect.onchange = () => {
fetch(`https://api.aladhan.com/v1/timingsByCity?city=${wilayaSelect.value}&country=Algeria&method=3`)
.then(r=>r.json())
.then(d=>{
let t=d.data.timings;
prayerTimes.innerHTML=`
Ø§Ù„ÙØ¬Ø±: ${t.Fajr}<br>
Ø§Ù„Ø¸Ù‡Ø±: ${t.Dhuhr}<br>
Ø§Ù„Ø¹ØµØ±: ${t.Asr}<br>
Ø§Ù„Ù…ØºØ±Ø¨: ${t.Maghrib}<br>
Ø§Ù„Ø¹Ø´Ø§Ø¡: ${t.Isha}
`;
});
};

// Ø§Ù„Ù‚Ø¨Ù„Ø© Ù…Ø¹ Ø§Ù‡ØªØ²Ø§Ø²
const kaabaLat=21.4225, kaabaLon=39.8262;
let vibrated=false;

navigator.geolocation.getCurrentPosition(pos=>{
const lat=pos.coords.latitude*Math.PI/180;
const lon=pos.coords.longitude*Math.PI/180;
const dLon=(kaabaLon*Math.PI/180)-lon;
const y=Math.sin(dLon)*Math.cos(kaabaLat*Math.PI/180);
const x=Math.cos(lat)*Math.sin(kaabaLat*Math.PI/180)-
Math.sin(lat)*Math.cos(kaabaLat*Math.PI/180)*Math.cos(dLon);
const qibla=(Math.atan2(y,x)*180/Math.PI+360)%360;

window.addEventListener("deviceorientation",e=>{
if(e.alpha==null)return;
const diff=Math.abs(qibla-e.alpha);
arrow.style.transform=`rotate(${qibla-e.alpha}deg)`;
if(diff<5||diff>355){
qiblaText.textContent="âœ”ï¸ Ø£Ù†Øª Ø¨Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ù‚Ø¨Ù„Ø©";
if(!vibrated && navigator.vibrate){
navigator.vibrate([200,100,200]);
vibrated=true;
}
}else{
qiblaText.textContent="Ø­Ø±Ù‘Ùƒ Ø§Ù„Ù‡Ø§ØªÙ";
vibrated=false;
}
});
});
</script>

</body>
</html>
