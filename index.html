<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù…Ø³Ù„Ù… Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±ÙŠ Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„</title>
    <style>
        :root { --gold: #f1c40f; --dark-bg: #0a0a0a; --card-bg: rgba(255,255,255,0.07); }
        body { background-color: var(--dark-bg); font-family: 'Segoe UI', sans-serif; color: white; margin: 0; padding: 20px; display: flex; flex-direction: column; align-items: center; }
        .container { width: 100%; max-width: 500px; display: flex; flex-direction: column; gap: 12px; }
        .card { background: var(--card-bg); border: 1px solid rgba(255,255,255,0.1); border-radius: 15px; padding: 18px; cursor: pointer; transition: 0.3s; }
        .card:hover { border-color: var(--gold); background: rgba(241,196,15,0.05); }
        #overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--dark-bg); z-index: 2000; padding: 10px; overflow-y: auto; text-align: center; }
        .quran-img { width: 100%; max-width: 450px; border-radius: 10px; border: 2px solid var(--gold); margin: 15px 0; }
        .btn-close { background: #e74c3c; color: white; border: none; padding: 15px; width: 100%; border-radius: 10px; font-weight: bold; cursor: pointer; margin-bottom: 20px; }
        .nav-btn { background: var(--gold); color: black; border: none; padding: 12px; border-radius: 8px; font-weight: bold; width: 48%; cursor: pointer; }
        .index-table { width: 100%; border-collapse: collapse; }
        .index-table tr { border-bottom: 1px solid rgba(255,255,255,0.1); cursor: pointer; }
        .index-table td { padding: 15px; text-align: right; }
        .prayer-card { background: rgba(241, 196, 15, 0.1); border: 1px solid var(--gold); padding: 10px; border-radius: 10px; margin: 5px 0; display: flex; justify-content: space-between; }
        .compass { position: relative; width: 200px; height: 200px; border: 5px solid var(--gold); border-radius: 50%; margin: 20px auto; }
        .arrow { position: absolute; width: 4px; height: 80px; background: red; top: 20px; left: 98px; transform-origin: bottom center; }
        .city-select { width: 100%; padding: 12px; border-radius: 10px; background: #222; color: white; border: 1px solid var(--gold); }
        .tafsir-box { background: #1a1a1a; padding: 15px; border-radius: 10px; text-align: right; margin-top: 10px; border-right: 4px solid var(--gold); }
    </style>
</head>
<body>

    <h2 style="color: var(--gold);">Ø§Ù„Ù…Ø³Ù„Ù… Ø§Ù„Ø´Ø§Ù…Ù„ - Ø§Ù„Ø¬Ø²Ø§Ø¦Ø± ğŸ‡©ğŸ‡¿</h2>

    <div class="container">
        <div class="card" onclick="openKhatma()"><h3>ğŸ“– Ø§Ù„Ø®ØªÙ…Ø© ÙˆØ§Ù„Ù‚Ø±Ø§Ø¡Ø©</h3><p id="status-text">Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©: 1</p></div>
        <div class="card" onclick="openFullIndex()"><h3>ğŸ“œ Ø§Ù„ÙÙ‡Ø±Ø³ ÙˆØ§Ù„ØªÙØ³ÙŠØ±</h3><p>ÙƒÙ„ Ø§Ù„Ø³ÙˆØ± ÙˆØ§Ù„Ø£Ø¬Ø²Ø§Ø¡ Ù…Ø¹ Ø§Ù„ØªÙØ³ÙŠØ±</p></div>
        <div class="card" onclick="openPrayers()"><h3>ğŸ•Œ Ø§Ù„ØµÙ„Ø§Ø© ÙˆØ§Ù„Ø£Ø°Ø§Ù†</h3><p>Ù…ÙˆØ§Ù‚ÙŠØª ÙƒØ§ÙØ© Ø§Ù„ÙˆÙ„Ø§ÙŠØ§Øª</p></div>
        <div class="card" onclick="openQibla()"><h3>ğŸ“ Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ù‚Ø¨Ù„Ø©</h3><p>Ø¨ÙˆØµÙ„Ø© Ø§Ù„ÙƒØ¹Ø¨Ø© Ø§Ù„Ù…Ø´Ø±ÙØ©</p></div>
        <div class="card" onclick="showDhikr('morning')">â˜€ï¸ Ø£Ø°ÙƒØ§Ø± Ø§Ù„ØµØ¨Ø§Ø­</div>
        <div class="card" onclick="showDhikr('evening')">ğŸŒ™ Ø£Ø°ÙƒØ§Ø± Ø§Ù„Ù…Ø³Ø§Ø¡</div>
    </div>

    <div id="overlay">
        <button class="btn-close" onclick="closeOverlay()">Ø¥ØºÙ„Ø§Ù‚ âœ–</button>
        <div id="content-area"></div>
    </div>

    <audio id="adhanAudio" src="https://www.islamcan.com/adhan/makkah.mp3"></audio>

    <script>
        let lastPage = localStorage.getItem('quranPage') || 1;
        document.getElementById('status-text').innerText = `Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©: ${lastPage}`;
        const cities = ["Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±", "ÙˆÙ‡Ø±Ø§Ù†", "Ù‚Ø³Ù†Ø·ÙŠÙ†Ø©", "Ø³Ø·ÙŠÙ", "Ø§Ù„ÙˆØ§Ø¯ÙŠ", "Ø¨Ø´Ø§Ø±", "ØªÙ…Ù†Ø±Ø§Ø³Øª", "Ø¹Ù†Ø§Ø¨Ø©", "ØªÙ„Ù…Ø³Ø§Ù†", "Ø§Ù„Ø¬Ù„ÙØ©"];

        // --- Ø§Ù„Ù‚Ø¨Ù„Ø© ---
        function openQibla() {
            document.getElementById('overlay').style.display = 'block';
            document.getElementById('content-area').innerHTML = `
                <h3 style="color:var(--gold)">Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ù‚Ø¨Ù„Ø©</h3>
                <div class="compass"><div id="arrow" class="arrow"></div></div>
                <p>ØªØ£ÙƒØ¯ Ù…Ù† ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù…ÙˆÙ‚Ø¹ (GPS)</p>`;
            if(navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(pos => {
                    const lat = pos.coords.latitude, lng = pos.coords.longitude;
                    const phiK = 21.4225 * Math.PI / 180, lambdaK = 39.8262 * Math.PI / 180;
                    const phi = lat * Math.PI / 180, lambda = lng * Math.PI / 180;
                    const y = Math.sin(lambdaK - lambda);
                    const x = Math.cos(phi) * Math.tan(phiK) - Math.sin(phi) * Math.cos(lambdaK - lambda);
                    let angle = Math.atan2(y, x) * 180 / Math.PI;
                    document.getElementById('arrow').style.transform = `rotate(${angle}deg)`;
                });
            }
        }

        // --- Ø§Ù„Ù…ÙˆØ§Ù‚ÙŠØª ÙˆØ§Ù„Ø£Ø°Ø§Ù† ---
        async function openPrayers() {
            document.getElementById('overlay').style.display = 'block';
            document.getElementById('content-area').innerHTML = `
                <select class="city-select" onchange="getTimes(this.value)">
                    ${cities.map(c => `<option value="${c}">${c}</option>`).join('')}
                </select>
                <div id="pTimes"></div>
                <button onclick="enableAdhan()" style="margin-top:10px; background:var(--gold); padding:10px; border-radius:5px; border:none;">ØªÙØ¹ÙŠÙ„ ØµÙˆØª Ø§Ù„Ø£Ø°Ø§Ù† ğŸ””</button>`;
            getTimes("Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±");
        }

        async function getTimes(city) {
            const res = await fetch(`https://api.aladhan.com/v1/timingsByCity?city=${city}&country=Algeria&method=3`);
            const data = await res.json();
            const t = data.data.timings;
            document.getElementById('pTimes').innerHTML = `
                <div class="prayer-card"><span>Ø§Ù„ÙØ¬Ø±</span><span>${t.Fajr}</span></div>
                <div class="prayer-card"><span>Ø§Ù„Ø¸Ù‡Ø±</span><span>${t.Dhuhr}</span></div>
                <div class="prayer-card"><span>Ø§Ù„Ø¹ØµØ±</span><span>${t.Asr}</span></div>
                <div class="prayer-card"><span>Ø§Ù„Ù…ØºØ±Ø¨</span><span>${t.Maghrib}</span></div>
                <div class="prayer-card"><span>Ø§Ù„Ø¹Ø´Ø§Ø¡</span><span>${t.Isha}</span></div>`;
        }

        function enableAdhan() { document.getElementById('adhanAudio').play().then(() => { document.getElementById('adhanAudio').pause(); alert("ØªÙ… Ø§Ù„ØªÙØ¹ÙŠÙ„!"); }); }

        // --- Ø§Ù„Ù…ØµØ­Ù ÙˆØ§Ù„ØªÙØ³ÙŠØ± ---
        const surahs = [{n:"Ø§Ù„ÙØ§ØªØ­Ø©",p:1},{n:"Ø§Ù„Ø¨Ù‚Ø±Ø©",p:2},{n:"Ø¢Ù„ Ø¹Ù…Ø±Ø§Ù†",p:50},{n:"Ø§Ù„Ù†Ø³Ø§Ø¡",p:77},{n:"Ø§Ù„Ù…Ø§Ø¦Ø¯Ø©",p:106},{n:"Ø§Ù„Ø£Ù†Ø¹Ø§Ù…",p:128},{n:"Ø§Ù„Ø£Ø¹Ø±Ø§Ù",p:151},{n:"Ø§Ù„Ø£Ù†ÙØ§Ù„",p:177},{n:"Ø§Ù„ØªÙˆØ¨Ø©",p:187},{n:"ÙŠÙˆÙ†Ø³",p:208},{n:"Ù‡ÙˆØ¯",p:221},{n:"ÙŠÙˆØ³Ù",p:235}];

        function openKhatma() { showPage(lastPage); }

        function showPage(num) {
            lastPage = num; localStorage.setItem('quranPage', num);
            document.getElementById('overlay').style.display = 'block';
            document.getElementById('content-area').innerHTML = `
                <h3>Ø§Ù„ØµÙØ­Ø© ${num}</h3>
                <img src="https://www.searchtruth.com/quran/images2/page${num}.png" class="quran-img">
                <button onclick="getTafsir(${num})" style="background:none; color:var(--gold); border:1px solid var(--gold); padding:5px; margin-bottom:10px;">Ø¹Ø±Ø¶ ØªÙØ³ÙŠØ± Ø§Ù„ØµÙØ­Ø©</button>
                <div id="tafsirArea"></div>
                <div style="display:flex; justify-content:space-between; margin-top:10px;">
                    <button class="nav-btn" onclick="showPage(${parseInt(num)+1})">Ø§Ù„ØªØ§Ù„ÙŠ</button>
                    <button class="nav-btn" onclick="showPage(${parseInt(num)-1})">Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
                </div>`;
        }

        async function getTafsir(page) {
            const area = document.getElementById('tafsirArea');
            area.innerHTML = "Ø¬Ø§Ø±ÙŠ Ø¬Ù„Ø¨ Ø§Ù„ØªÙØ³ÙŠØ± Ø§Ù„Ù…ÙŠØ³Ø±...";
            const res = await fetch(`https://api.alquran.cloud/v1/page/${page}/ar.jalalayn`);
            const data = await res.json();
            area.innerHTML = data.data.ayahs.map(a => `<div class="tafsir-box"><strong>Ø¢ÙŠØ© ${a.numberInSurah}:</strong><br>${a.text}</div>`).join('');
        }

        function openFullIndex() {
            document.getElementById('overlay').style.display = 'block';
            let html = `<table class="index-table">`;
            surahs.forEach(s => html += `<tr onclick="showPage(${s.p})"><td>${s.n}</td><td style="color:var(--gold)">${s.p}</td></tr>`);
            document.getElementById('content-area').innerHTML = html + `</table>`;
        }

        function showDhikr(type) {
            const imgs = { morning: 'https://i.ibb.co/Vp6zK0S/1000032449.jpg', evening: 'https://i.ibb.co/L9YmN4V/1000032450.jpg' };
            document.getElementById('overlay').style.display = 'block';
            document.getElementById('content-area').innerHTML = `<img src="${imgs[type]}" class="quran-img">`;
        }

        function closeOverlay() { document.getElementById('overlay').style.display = 'none'; document.getElementById('status-text').innerText = `Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©: ${lastPage}`; }
    </script>
</body>
</html>
