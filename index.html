<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù…Ø³Ù„Ù… Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±ÙŠ Ø§Ù„Ø´Ø§Ù…Ù„ ğŸŒ™</title>
    <style>
        :root { --gold: #f1c40f; --card-bg: rgba(255, 255, 255, 0.1); }
        body {
            background: linear-gradient(rgba(0,0,0,0.85), rgba(0,0,0,0.85)), url('https://images.unsplash.com/photo-1609599006353-e629aaabfeae?q=80&w=2070');
            background-size: cover; background-attachment: fixed; font-family: 'Segoe UI', sans-serif;
            margin: 0; padding: 20px; display: flex; flex-direction: column; align-items: center; color: white;
        }
        .container { display: flex; flex-direction: column; gap: 15px; width: 100%; max-width: 500px; }
        .diamond-card { background: var(--card-bg); backdrop-filter: blur(15px); border: 2px solid rgba(255,255,255,0.5); border-radius: 20px; padding: 20px; display: flex; align-items: center; cursor: pointer; transition: 0.4s; }
        .diamond-card:hover { border-color: var(--gold); transform: scale(1.02); }
        #overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.98); z-index: 2000; padding: 20px; overflow-y: auto; text-align: center; }
        .quran-img { width: 100%; max-width: 450px; border-radius: 10px; border: 2px solid var(--gold); margin-bottom: 20px; }
        .nav-btn { background: var(--gold); color: black; border: none; padding: 12px; border-radius: 10px; width: 48%; font-weight: bold; cursor: pointer; }
        .close-btn { background: #e74c3c; color: white; border: none; padding: 12px; border-radius: 10px; width: 100%; font-weight: bold; cursor: pointer; margin-bottom: 20px; }
        .prayer-card { background: rgba(241, 196, 15, 0.15); border: 1px solid var(--gold); padding: 15px; border-radius: 15px; margin: 10px 0; display: flex; justify-content: space-between; font-size: 1.2rem; }
        .search-box, .city-select { width: 90%; padding: 15px; border-radius: 10px; border: 2px solid var(--gold); background: black; color: white; margin-bottom: 15px; font-size: 18px; }
    </style>
</head>
<body>
    <h1 style="color:var(--gold); text-shadow: 0 0 10px rgba(241,196,15,0.5);">Ø§Ù„Ù…Ø³Ù„Ù… Ø§Ù„Ø´Ø§Ù…Ù„ - Ø§Ù„Ø¬Ø²Ø§Ø¦Ø± ğŸ‡©ğŸ‡¿</h1>
    
    <div class="container">
        <div class="diamond-card" onclick="openPrayers()"><i>ğŸ•Œ</i><div style="margin-right:15px;"><h2>Ø§Ù„ØµÙ„Ø§Ø© ÙˆØ§Ù„Ø£Ø°Ø§Ù†</h2><p>Ù…ÙˆØ§Ù‚ÙŠØª ÙˆÙ„Ø§ÙŠØ§Øª Ø§Ù„Ø¬Ø²Ø§Ø¦Ø± Ø¨Ø¯Ù‚Ø©</p></div></div>
        <div class="diamond-card" onclick="startKhatma()"><i>ğŸ“–</i><div style="margin-right:15px;"><h2>Ø®ØªÙ…Ø© Ø±Ù…Ø¶Ø§Ù†</h2><p id="khatma-status">Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© Ù…Ù† ØµÙØ­Ø© ${localStorage.getItem('lastPage') || 1}</p></div></div>
        <div class="diamond-card" onclick="openSearch()"><i>ğŸ”</i><div style="margin-right:15px;"><h2>Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù‚Ø±Ø¢Ù†</h2><p>Ø§Ø¨Ø­Ø« Ø¹Ù† Ø¢ÙŠØ© ÙˆØ§Ø¹Ø±Ù Ù…Ø§Ø¨Ø¹Ø¯Ù‡Ø§</p></div></div>
        <div class="diamond-card" onclick="openS('morning')"><i>â˜€ï¸</i><div style="margin-right:15px;"><h2>Ø£Ø°ÙƒØ§Ø± Ø§Ù„ØµØ¨Ø§Ø­</h2><p>Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ù…ØµÙˆØ±Ø©</p></div></div>
        <div class="diamond-card" onclick="openS('evening')"><i>ğŸŒ™</i><div style="margin-right:15px;"><h2>Ø£Ø°ÙƒØ§Ø± Ø§Ù„Ù…Ø³Ø§Ø¡</h2><p>Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ù…ØµÙˆØ±Ø©</p></div></div>
        <div class="diamond-card" onclick="openS('sleep')"><i>ğŸ’¤</i><div style="margin-right:15px;"><h2>Ø£Ø°ÙƒØ§Ø± Ø§Ù„Ù†ÙˆÙ…</h2><p>Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ù…ØµÙˆØ±Ø©</p></div></div>
    </div>

    <div id="overlay">
        <button class="close-btn" onclick="closeOverlay()">Ø¥ØºÙ„Ø§Ù‚ ÙˆØ­ÙØ¸ âœ–</button>
        <div id="content"></div>
    </div>

    <audio id="adhanAudio" src="https://www.islamcan.com/adhan/makkah.mp3"></audio>

    <script>
        let currentPage = parseInt(localStorage.getItem('lastPage')) || 1;
        let prayerTimings = {};
        const cities = ["Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±", "ÙˆÙ‡Ø±Ø§Ù†", "Ù‚Ø³Ù†Ø·ÙŠÙ†Ø©", "Ø¹Ù†Ø§Ø¨Ø©", "Ø³Ø·ÙŠÙ", "ØªÙ„Ù…Ø³Ø§Ù†", "Ø§Ù„Ø¬Ù„ÙØ©", "Ø¨Ø´Ø§Ø±", "ÙˆØ±Ù‚Ù„Ø©", "Ø§Ù„ÙˆØ§Ø¯ÙŠ", "ØªÙ…Ù†Ø±Ø§Ø³Øª", "Ù…Ø³ØªØºØ§Ù†Ù…", "Ø¨Ø¬Ø§ÙŠØ©", "Ø³ÙƒÙŠÙƒØ¯Ø©", "Ø§Ù„Ø¨Ù„ÙŠØ¯Ø©"];

        // --- ÙˆØ¸Ø§Ø¦Ù Ø§Ù„ØµÙ„Ø§Ø© ÙˆØ§Ù„Ø£Ø°Ø§Ù† ---
        async function openPrayers() {
            const list = document.getElementById('content');
            document.getElementById('overlay').style.display = 'block';
            list.innerHTML = `
                <h2 style="color:var(--gold)">Ù…ÙˆØ§Ù‚ÙŠØª Ø§Ù„ØµÙ„Ø§Ø© ÙˆØ§Ù„Ø£Ø°Ø§Ù†</h2>
                <select id="citySelect" class="city-select" onchange="fetchPrayers(this.value)">
                    ${cities.map(c => `<option value="${c}">${c}</option>`).join('')}
                </select>
                <div id="prayerResults"></div>
                <button onclick="enableAudio()" style="padding:15px; width:90%; border-radius:10px; background:var(--gold); border:none; font-weight:bold; margin-top:10px;">ØªÙØ¹ÙŠÙ„ Ù…Ù†Ø¨Ù‡ Ø§Ù„Ø£Ø°Ø§Ù† ğŸ””</button>
            `;
            fetchPrayers("Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±");
        }

        async function fetchPrayers(city) {
            const resDiv = document.getElementById('prayerResults');
            const res = await fetch(`https://api.aladhan.com/v1/timingsByCity?city=${city}&country=Algeria&method=3`);
            const data = await res.json();
            prayerTimings = data.data.timings;
            resDiv.innerHTML = `
                <div class="prayer-card"><span>Ø§Ù„ÙØ¬Ø±</span> <span>${prayerTimings.Fajr}</span></div>
                <div class="prayer-card"><span>Ø§Ù„Ø¸Ù‡Ø±</span> <span>${prayerTimings.Dhuhr}</span></div>
                <div class="prayer-card"><span>Ø§Ù„Ø¹ØµØ±</span> <span>${prayerTimings.Asr}</span></div>
                <div class="prayer-card"><span>Ø§Ù„Ù…ØºØ±Ø¨</span> <span>${prayerTimings.Maghrib}</span></div>
                <div class="prayer-card"><span>Ø§Ù„Ø¹Ø´Ø§Ø¡</span> <span>${prayerTimings.Isha}</span></div>
            `;
            setInterval(checkAdhan, 60000);
        }

        function enableAudio() {
            const audio = document.getElementById('adhanAudio');
            audio.play().then(() => { audio.pause(); alert("ØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø£Ø°Ø§Ù† Ø¨Ù†Ø¬Ø§Ø­!"); });
        }

        function checkAdhan() {
            const now = new Date();
            const current = now.getHours().toString().padStart(2, '0') + ":" + now.getMinutes().toString().padStart(2, '0');
            if (Object.values(prayerTimings).includes(current)) { document.getElementById('adhanAudio').play(); }
        }

        // --- ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø®ØªÙ…Ø© ÙˆØ§Ù„Ù‚Ø±Ø¢Ù† ---
        function startKhatma() {
            document.getElementById('overlay').style.display = 'block';
            loadPage();
        }

        function loadPage() {
            const list = document.getElementById('content');
            list.innerHTML = `
                <h3 style="color:var(--gold)">Ø§Ù„ØµÙØ­Ø© Ø±Ù‚Ù… ${currentPage}</h3>
                <img src="https://www.searchtruth.com/quran/images2/page${currentPage}.png" class="quran-img">
                <div style="display:flex; justify-content:space-between; margin:20px auto; max-width:450px;">
                    <button class="nav-btn" onclick="changePage(1)">Ø§Ù„ØªØ§Ù„ÙŠ</button>
                    <button class="nav-btn" onclick="changePage(-1)">Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
                </div>
            `;
            localStorage.setItem('lastPage', currentPage);
        }

        function changePage(step) {
            if ((currentPage + step) >= 1 && (currentPage + step) <= 604) {
                currentPage += step;
                loadPage();
            }
        }

        // --- ÙˆØ¸ÙŠÙØ© Ø§Ù„Ø¨Ø­Ø« ---
        function openSearch() {
            const list = document.getElementById('content');
            document.getElementById('overlay').style.display = 'block';
            list.innerHTML = `
                <h2 style="color:var(--gold)">Ø¨Ø­Ø« ÙÙŠ Ø¢ÙŠØ§Øª Ø§Ù„Ù„Ù‡</h2>
                <input type="text" id="searchInput" class="search-box" placeholder="Ø§ÙƒØªØ¨ Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø¢ÙŠØ©..." oninput="searchAyah()">
                <div id="searchResults"></div>
            `;
        }

        async function searchAyah() {
            const query = document.getElementById('searchInput').value;
            if (query.length < 3) return;
            const res = await fetch(`https://api.alquran.cloud/v1/search/${query}/all/ar`);
            const data = await res.json();
            if (data.data.results.length > 0) {
                const ayah = data.data.results[0];
                document.getElementById('searchResults').innerHTML = `
                    <div style="background:rgba(0,0,0,0.5); padding:15px; border-radius:10px; margin-top:10px;">
                        <p>${ayah.text}</p>
                        <button class="nav-btn" style="width:100%" onclick="goToPage(${ayah.page})">Ø§Ø°Ù‡Ø¨ Ù„Ù„ØµÙØ­Ø© ${ayah.page}</button>
                    </div>`;
            }
        }

        function goToPage(page) {
            currentPage = page;
            loadPage();
        }

        function openS(type) {
            const list = document.getElementById('content');
            const imgs = {
                morning: 'https://i.ibb.co/Vp6zK0S/1000032449.jpg',
                evening: 'https://i.ibb.co/L9YmN4V/1000032450.jpg',
                sleep: 'https://i.ibb.co/Rh0Xn7z/1000032448.jpg'
            };
            document.getElementById('overlay').style.display = 'block';
            list.innerHTML = `<img src="${imgs[type]}" class="quran-img">`;
        }

        function closeOverlay() {
            document.getElementById('overlay').style.display = 'none';
            document.getElementById('khatma-status').innerText = `Ø£Ù†Øª ÙÙŠ Ø§Ù„ØµÙØ­Ø© Ø±Ù‚Ù… ${currentPage}`;
        }
    </script>
</body>
</html>
